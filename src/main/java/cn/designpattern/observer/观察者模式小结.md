# 观察者模式（Observer）

## 描述

1. 别名：

   1. 发布（Publish）-订阅（Subscribe）模式；
   2. 模型（Model）-视图（View）模式；
   3. 源 - 收听者（Listener）模式。

2. 功能概述：

   ​		**一个被观察者**，管理所有依赖于它的**多个观察者**，并且在被观察者本身**状态发生改变**时候通知所有观察者。是一种一对多的关联关系引用，通常被用于事件处理系统。

## 模式结构图

![观察者模式结构图](./observer_pattern.svg)

## 角色解析

1. 抽象观察者 Observer

   为所有具体的观察者定义一个接口，在收到主题通知时候更新自己。

2. 抽象被观察者 Subject

   把所有观察者对象的引用保存到一个集合中，每个主题都可以有任意数量的观察者。抽象主题提供一个接口，可以**增加和删除观察者角色**。

3. 具体的被观察者 Concrete Subject

   具体的主题，在所有内部主题发生改变时候，向所有登记的观察者对象发出通知。

4. 具体的观察者 Concrete Observer

   实现抽象观察者所需的更新方法，使本身的状态与视图状态一致。

## 具体实现

   此处不再解析具体实现，详细见**代码注释**。

## JDK实现观察者模式分析

JDK中，java.util.Observable 抽象类和 java.util.Observer 接口，分别是JDK提供的抽象被观察者和抽象观察者。我们进行使用的时候，继承或实现他们，并重写相应方法即可。

### 抽象观察者 Observer

```java
package java.util;

/**
 * A class can implement the <code>Observer</code> interface when it
 * wants to be informed of changes in observable objects.
 *
 * @author  Chris Warth
 * @see     java.util.Observable
 * @since   JDK1.0
 */
public interface Observer {
    /**
     * This method is called whenever the observed object is changed. An
     * application calls an <tt>Observable</tt> object's
     * <code>notifyObservers</code> method to have all the object's
     * observers notified of the change.
     *
     * @param   o     the observable object.
     * @param   arg   an argument passed to the <code>notifyObservers</code>
     *                 method.
     */
    void update(Observable o, Object arg);
}

```

此接口很简单，提供一个更新消息的方法。两个参数

1. Observable ==> 发通知的被观察者。
2. Object args ==> 通知的内容。

### 抽象被观察者 Observable

